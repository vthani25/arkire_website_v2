var G=(e,r,s)=>!e&&s?I(s):R(r),I=e=>{const r=e.userId,s=e.user,t=e.sessionId,n=e.sessionStatus,o=e.sessionClaims,c=e.session,l=e.organization,u=e.orgId,a=e.orgRole,i=e.orgPermissions,h=e.orgSlug,d=e.actor,g=e.factorVerificationAge;return{userId:r,user:s,sessionId:t,session:c,sessionStatus:n,sessionClaims:o,organization:l,orgId:u,orgRole:a,orgPermissions:i,orgSlug:h,actor:d,factorVerificationAge:g}},R=e=>{const r=e.user?e.user.id:e.user,s=e.user,t=e.session?e.session.id:e.session,n=e.session,o=e.session?.status,c=e.session?e.session.lastActiveToken?.jwt?.claims:null,l=e.session?e.session.factorVerificationAge:null,u=n?.actor,a=e.organization,i=e.organization?e.organization.id:e.organization,h=a?.slug,d=a&&s?.organizationMemberships?.find(M=>M.organization.id===i),g=d&&d.permissions,P=d&&d.role;return{userId:r,user:s,sessionId:t,session:n,sessionStatus:o,sessionClaims:c,organization:a,orgId:i,orgRole:P,orgSlug:h,orgPermissions:g,actor:u,factorVerificationAge:l}},b=e=>typeof atob<"u"&&typeof atob=="function"?atob(e):typeof global<"u"&&global.Buffer?new global.Buffer(e,"base64").toString():e,S=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"],m="pk_live_",_="pk_test_";function f(e,r={}){if(e=e||"",!e||!p(e)){if(r.fatal&&!e)throw new Error("Publishable key is missing. Ensure that your publishable key is correctly configured. Double-check your environment configuration for your keys, or access them here: https://dashboard.clerk.com/last-active?path=api-keys");if(r.fatal&&!p(e))throw new Error("Publishable key not valid.");return null}const s=e.startsWith(m)?"production":"development";let t=b(e.split("_")[2]);return t=t.slice(0,-1),r.proxyUrl?t=r.proxyUrl:s!=="development"&&r.domain&&r.isSatellite&&(t=`clerk.${r.domain}`),{instanceType:s,frontendApi:t}}function p(e=""){try{const r=e.startsWith(m)||e.startsWith(_),s=b(e.split("_")[2]||"").endsWith("$");return r&&s}catch{return!1}}function x(){const e=new Map;return{isDevOrStagingUrl:r=>{if(!r)return!1;const s=typeof r=="string"?r:r.hostname;let t=e.get(s);return t===void 0&&(t=S.some(n=>s.endsWith(n)),e.set(s,t)),t}}}var U=(e,r="5.69.0")=>{if(e)return e;const s=A(r);return s?s==="snapshot"?"5.69.0":s:C(r)},A=e=>e.trim().replace(/^v/,"").match(/-(.+?)(\.|$)/)?.[1],C=e=>e.trim().replace(/^v/,"").split(".")[0];function K(e){return e?L(e)||v(e):!0}function L(e){return/^http(s)?:\/\//.test(e||"")}function v(e){return e.startsWith("/")}function D(e){return e?v(e)?new URL(e,window.location.origin).toString():e:""}function O(e){if(!e)return"";let r;if(e.match(/^(clerk\.)+\w*$/))r=/(clerk\.)*(?=clerk\.)/;else{if(e.match(/\.clerk.accounts/))return e;r=/^(clerk\.)*/gi}return`clerk.${e.replace(r,"")}`}var T={initialDelay:125,maxDelayBetweenRetries:0,factor:2,shouldRetry:(e,r)=>r<5,retryImmediately:!1,jitter:!0},$=100,k=async e=>new Promise(r=>setTimeout(r,e)),w=(e,r)=>r?e*(1+Math.random()):e,z=e=>{let r=0;const s=()=>{const t=e.initialDelay,n=e.factor;let o=t*Math.pow(n,r);return o=w(o,e.jitter),Math.min(e.maxDelayBetweenRetries||o,o)};return async()=>{await k(s()),r++}},F=async(e,r={})=>{let s=0;const{shouldRetry:t,initialDelay:n,maxDelayBetweenRetries:o,factor:c,retryImmediately:l,jitter:u}={...T,...r},a=z({initialDelay:n,maxDelayBetweenRetries:o,factor:c,jitter:u});for(;;)try{return await e()}catch(i){if(s++,!t(i,s))throw i;l&&s===1?await k(w($,u)):await a()}},V="loadScript cannot be called when document does not exist",j="loadScript cannot be called without a src";async function B(e="",r){const{async:s,defer:t,beforeLoad:n,crossOrigin:o,nonce:c}=r||{};return F(()=>new Promise((u,a)=>{e||a(new Error(j)),(!document||!document.body)&&a(V);const i=document.createElement("script");o&&i.setAttribute("crossorigin",o),i.async=s||!1,i.defer=t||!1,i.addEventListener("load",()=>{i.remove(),u(i)}),i.addEventListener("error",()=>{i.remove(),a()}),i.src=e,i.nonce=c,n?.(i),document.body.appendChild(i)}),{shouldRetry:(u,a)=>a<=5})}var J=Object.freeze({InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingSecretKeyErrorMessage:"Missing secretKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingClerkProvider:"{{source}} can only be used within the <ClerkProvider /> component. Learn more: https://clerk.com/docs/components/clerk-provider"});function N({packageName:e,customMessages:r}){let s=e;const t={...J,...r};function n(o,c){if(!c)return`${s}: ${o}`;let l=o;const u=o.matchAll(/{{([a-zA-Z0-9-_]+)}}/g);for(const a of u){const i=(c[a[1]]||"").toString();l=l.replace(`{{${a[1]}}}`,i)}return`${s}: ${l}`}return{setPackageName({packageName:o}){return typeof o=="string"&&(s=o),this},setMessages({customMessages:o}){return Object.assign(t,o||{}),this},throwInvalidPublishableKeyError(o){throw new Error(n(t.InvalidPublishableKeyErrorMessage,o))},throwInvalidProxyUrl(o){throw new Error(n(t.InvalidProxyUrlErrorMessage,o))},throwMissingPublishableKeyError(){throw new Error(n(t.MissingPublishableKeyErrorMessage))},throwMissingSecretKeyError(){throw new Error(n(t.MissingSecretKeyErrorMessage))},throwMissingClerkProviderError(o){throw new Error(n(t.MissingClerkProvider,o))},throw(o){throw new Error(n(o))}}}var y="Clerk: Failed to load Clerk",{isDevOrStagingUrl:Y}=x(),E=N({packageName:"@clerk/shared"});function q(e){E.setPackageName({packageName:e})}var Z=async e=>{const r=document.querySelector("script[data-clerk-js-script]");if(r)return new Promise((s,t)=>{r.addEventListener("load",()=>{s(r)}),r.addEventListener("error",()=>{t(y)})});if(!e?.publishableKey){E.throwMissingPublishableKeyError();return}return B(W(e),{async:!0,crossOrigin:"anonymous",nonce:e.nonce,beforeLoad:X(e)}).catch(()=>{throw new Error(y)})},W=e=>{const{clerkJSUrl:r,clerkJSVariant:s,clerkJSVersion:t,proxyUrl:n,domain:o,publishableKey:c}=e;if(r)return r;let l="";n&&K(n)?l=D(n).replace(/http(s)?:\/\//,""):o&&!Y(f(c)?.frontendApi||"")?l=O(o):l=f(c)?.frontendApi||"";const u=s?`${s.replace(/\.+$/,"")}.`:"",a=U(t);return`https://${l}/npm/@clerk/clerk-js@${a}/dist/clerk.${u}browser.js`},H=e=>{const r={};return e.publishableKey&&(r["data-clerk-publishable-key"]=e.publishableKey),e.proxyUrl&&(r["data-clerk-proxy-url"]=e.proxyUrl),e.domain&&(r["data-clerk-domain"]=e.domain),e.nonce&&(r.nonce=e.nonce),r},X=e=>r=>{const s=H(e);for(const t in s)r.setAttribute(t,s[t])};export{N as b,G as d,p as i,Z as l,q as s};
